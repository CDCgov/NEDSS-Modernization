name: Build NBS6 Windows Container Build
on:
  workflow_dispatch:
    inputs: 
        container_name:
          description: "Name of container in ECR. Example: cdc-nbs-classic/<Container-Name>"
          type: string
          required: true
          default: "nbs6"
        nbs6_version:
          description: "NBS6 Version. This will be used to pull NBS ZIP from S3 Bucker in Shared Account and Tag Docker Image"
          type: string
          required: true
          default: "6.0.15.1"
        dockerfile_relative_path:
          description: "Relative path to dockerfile being built (use '-f' docker argument if the dockerfile referenced from the root directory)."
          type: string
          required: true
          default: "./cdc-sandbox/nbs6-win-container/"    
        zip_file_name:
          description: "Full zip file name and file format to be downloaded from latest Release Assets in Modernization Repository"
          type: string
          required: true
          default: "v7.2.2.NEDSS.NBS.Modernized.Documentation.zip"
        user_guide_doc_name:
          description: "Full user guide name with file format to be configured in NBS6 container. This will be overwritten to NBS User Training Guide.pdf"
          type: string
          required: true
          default: "NBS 7.2.2 User Guide.docx"       
  push:
    branches:
      - nbs6-docker-image
    paths:
      - "cdc-sandbox/nbs6-win-container/**"
jobs:
  call-build-windows-container-workflow:
    name: Build Windows Container
    uses: CDCgov/NEDSS-Workflows/.github/workflows/Build-windows-container.yaml@nbs6-docker-image
    with:
      container_name: ${{ inputs.container_name }}
      nbs6_version: ${{ inputs.nbs6_version }}
      dockerfile_relative_path: ${{ inputs.dockerfile_relative_path }}
      zip_file_name: ${{ inputs.zip_file_name }}
      user_guide_doc_name: ${{ inputs.user_guide_doc_name }}
    secrets:
      CDC_NBS_SANDBOX_SHARED_SERVICES_ACCOUNTID: ${{secrets.CDC_NBS_SANDBOX_SHARED_SERVICES_ACCOUNTID}}
      ECR_CLASSIC_REPO_BASE_NAME: ${{secrets.ECR_CLASSIC_REPO_BASE_NAME}}
      CLASSIC_ZIP_S3_BUCKET: ${{secrets.CLASSIC_ZIP_S3_BUCKET}}
      USER_GUIDE_S3_BUCKET: ${{secrets.USER_GUIDE_S3_BUCKET}}