http:
  routers:
    # Modernization app
    modernizationForward:
      service: modernization
      rule: "PathPrefix(`/`)"
    # Base /nbs forward
    nbsForward:
      service: nbs
      rule: "PathPrefix(`/nbs`)"
    # NBS to modernization overrides
    simpleSearch:
      service: modernization
      rule: "Path(`/nbs/HomePage.do`) && Query(`method=patientSearchSubmit`)"
      middlewares:
        - "simpleSearchRewritepath"
    advancedSearch:
      service: modernization
      middlewares:
        - "advancedSearchRewritepath"
      rule: "Path(`/nbs/MyTaskList1.do`)&& Query(`ContextAction=GlobalPatient`)"
    # Non '/nbs' NBS routes
    nbsLogo:
      service: nbs
      rule: "Path(`/images/nedssLogo.jpg`)"
  middlewares:
    simpleSearchRewritepath:
      replacePath:
        path: /nbs/redirect/simpleSearch
    advancedSearchRewritepath:
      replacePath:
        path: /nbs/redirect/advancedSearch
  services:
    modernization:
      loadBalancer:
        servers:
          - url: "http://modernization-api:8080/"
    nbs:
      loadBalancer:
        servers:
          - url: "http://wildfly:7001/"
