# Patient Search

The Patient Search API uses Elasticsearch to return resolve patient search results for a given criteria.  

## Person index mapping

The `person` index contains patient demographic data.

| Field                      | Description                                                                                       | Source column                                                                           | Notes                                                                                                                                                                          |
|----------------------------|---------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| cd                         | Classifier of the Person table, `PAT` signifies patient                                           | Person.cd                                                                               |                                                                                                                                                                                |
| person_uid                 | Unique identifier of a Person                                                                     | Person.person_uid                                                                       |                                                                                                                                                                                |
| local_id                   | Local system defined identifier of a patient                                                      | Person.local_id                                                                         |                                                                                                                                                                                |
| short_id                   | The "Patient ID" displayed on a Patient file that is derived from the local_id                    | `derived value`                                                                         |                                                                                                                                                                                |
| record_status_cd           | The status of a patient used to determine if a patient is active or inactive                      | Person.record_status_cd                                                                 |                                                                                                                                                                                |
| birth_time                 | The Patient's Date of birth                                                                       | Person.birth_time                                                                       |                                                                                                                                                                                |
| deceased_ind_cd            | Indication of if the patient is deceased                                                          | Person.deceased_ind_cd                                                                  |                                                                                                                                                                                |
| curr_sex_cd                | The gender of a patient                                                                           | Person.curr_sex_cd                                                                      |                                                                                                                                                                                |
| ethnic_group_ind           | Ethnicity of a patient                                                                            | Person.ethnic_group_ind                                                                 | Not currently searchable                                                                                                                                                       |
| name                       | Names of a patient                                                                                | Person_name                                                                             | A nested field that contains all names associated with a patient.                                                                                                              |
| name.firstNm               | First name of a patient                                                                           | Person_name.first_nm                                                                    |                                                                                                                                                                                |
| name.firstNmSndx           | Soundex encoded first name of a patient                                                           | `derived from Person_name.first_nm`                                                     | Soundex encoder is used to obtain the value                                                                                                                                    |
| name.last_nm               | Last name of a patient                                                                            | Person_name.last_nm                                                                     |                                                                                                                                                                                |
| name.lastNmSndx            | Soundex encoded last name of a patient                                                            | `derived from Person_name.last_nm`                                                      | Soundex encoder is used to obtain the value                                                                                                                                    |
| name.middleNm              | Middle name of a patient                                                                          | Person_name.middle_nm                                                                   |                                                                                                                                                                                |
| name.nmSuffix              | Coded value for the name suffix of a patient                                                      | Person_name.nm_suffix                                                                   |                                                                                                                                                                                |
| name.nm_use_cd             | Coded value for the name type of a patient                                                        | Person_name.nm_use_cd                                                                   |                                                                                                                                                                                |
| name.full                  | The full name of a patient                                                                        | `derived from {last_name} {first_name} {middle_name} {suffix_coded_value_description}`  | Uses coded value descriptions and not the ids.                                                                                                                                 |
| address                    | Addresses associated with a patient                                                               | Entity_locator_participation, Postal_locator                                            | A nested field that contains all addresses associated with a patient ordered by the as_of_date and locator_uid.                                                                |
| address.streetAddr1        | Street address 1 of the address                                                                   | Postal_locator.street_addr1                                                             |                                                                                                                                                                                |
| address.streetAddr2        | Street address 2 of the address                                                                   | Postal_locator.street_addr2                                                             |                                                                                                                                                                                |
| address.city               | City of the address                                                                               | Postal_locator.city_desc_txt                                                            |                                                                                                                                                                                |
| address.zip                | Postal code of the address                                                                        | Postal_locator.zip_cd                                                                   |                                                                                                                                                                                |
| address.state              | Coded value for the state of the address                                                          | Postal_locator.state_cd                                                                 |                                                                                                                                                                                |
| address.stateText          | Coded value description for the state of the address                                              | NBS_SRTE.dbo.State_code.code_desc_txt                                                   |                                                                                                                                                                                |
| address.cntyCd             | Coded value for the county of the address                                                         | Postal_locator.cnty_cd                                                                  |                                                                                                                                                                                |
| address.cntyText           | Coded value description for the county of the address                                             | NBS_SRTE.dbo.State_county_code_value.code_desc_txt                                      |                                                                                                                                                                                |
| address.cntryCd            | Coded value for the country of the address                                                        | Postal_locator.cntry_cd                                                                 |                                                                                                                                                                                |
| address.cntryText          | Coded value description for the country of the address                                            | NBS_SRTE.dbo.Country_code.code_short_desc_txt                                           |                                                                                                                                                                                |
| address.full               | The full address of a patient                                                                     | `derived from {streetAddr1} {streetAddr2} {city} {state_coded_value_description} {zip}` | Uses coded value descriptions and not the ids.                                                                                                                                 |
| phone                      | Phone numbers associated with a patient                                                           | Entity_locator_participation, Tele_locator                                              | A nested field that contains all phones associated with a patient ordered by the as_of_date and locator_uid.                                                                   |
| phone.typeCd               | Coded value for the phone type of the phone number                                                | Tele_locator.cd                                                                         |                                                                                                                                                                                |
| phone.useCd                | Coded value for the phone use of the phone number                                                 | Tele_locator.use_cd                                                                     |                                                                                                                                                                                |
| phone.telephoneNbr         | Telephone number of the patient                                                                   | Tele_locator.phone_nbr_txt                                                              |                                                                                                                                                                                |
| phone.extensionTxt         | The phone extension of the phone number of the patient                                            | Tele_locator.extension_txt                                                              |                                                                                                                                                                                |
| email                      | Email addresses associated with a patient                                                         | Entity_locator_participation, Tele_locator                                              | A nested field that contains all email addresses associated with a patient ordered by the as_of_date and locator_uid.                                                          |
| email.emailAddress         | Email address of the patient                                                                      | Tele_locator.email_address                                                              |                                                                                                                                                                                |
| race                       | Races of a patient                                                                                | Person_race                                                                             | A nested field that contains all races of a patient.                                                                                                                           |
| race.raceCategoryCd        | Coded value for the race category of a patient                                                    | Person_race.race_category_cd                                                            |                                                                                                                                                                                |
| race.raceCd                | Coded value for the detailed race of a patient                                                    | Person_race.race_cd                                                                     |                                                                                                                                                                                |
| entity_id                  | Identifications of a patient                                                                      | Entity_id                                                                               | A nested field that contains all identifications of a patient ordered by the as_of_date and entity_id_seq.                                                                     |
| entity_id.typeCd           | Coded value for the type of identification                                                        | Entity_id.type_cd                                                                       |                                                                                                                                                                                |
| entity_id.rootExtensionTxt | ID value of the identification                                                                    | Entity_id.root_extension_txt                                                            |                                                                                                                                                                                |
| document_ids               | Local system identifiers for any Documents associated with the patient                            | NBS_Document.local_id                                                                   | A comma delimited list of identifiers linked to the patient using the `NBS_Document`, and `Participation` tables.                                                              |
| morbidity_report_ids       | Local system identifiers for any Morbidity Reports associated with the patient                    | Observation.local_id                                                                    | A comma delimited list of identifiers linked to the patient using the `Observation`, and `Participation` tables.                                                               |
| treatment_ids              | Local system identifiers for any Treatments associated with the patient                           | Treatment.local_id                                                                      | A comma delimited list of identifiers linked to the patient using the `Treatment`, and `Participation` tables.                                                                 |
| vaccination_ids            | Local system identifiers for any Vaccinations associated with the patient                         | Intervention.local_id                                                                   | A comma delimited list of identifiers linked to the patient using the `Intervention`, and `Participation` tables.                                                              |
| investigation_ids          | Local system identifiers for any Investigation associated with the patient                        | Public_health_case.local_id                                                             | A comma delimited list of identifiers for Identifications linked to the patient using the `Public_health_case`, and `Participation` tables.                                    |
| abcs_case_ids              | Local system identifiers for any ABCS Cases associated with the patient through an Investigation  | Act_id.root_extension_txt                                                               | A comma delimited list of identifiers for Identifications linked to the patient through an Investigation using the `Public_health_case`, and `Act_id` tables.                  |
| city_case_ids              | Local system identifiers for any City Cases associated with the patient through an Investigation  | Act_id.root_extension_txt                                                               | A comma delimited list of identifiers for Identifications linked to the patient through an Investigation using the `Public_health_case`, and `Act_id` tables.                  |
| state_case_ids             | Local system identifiers for any State Cases associated with the patient through an Investigation | Act_id.root_extension_txt                                                               | A comma delimited list of identifiers for Identifications linked to the patient through an Investigation using the `Public_health_case`, `Participation`, and `Act_id` tables. |
| lab_report_ids             | Local system identifiers for any Lab Reports associated with the patient                          | Observation.local_id                                                                    | A comma delimited list of identifiers linked to the patient using the `Observation`, and `Participation` tables.                                                               |
| accession_ids              | Local system identifiers for any Accessions associated with the patient through a Lab Report      | Act_id.root_extension_txt                                                               | A comma delimited list of identifiers for Identifications linked to the patient through an Lab Report using the `Observation`, and `Act_id` tables.                            |
| notification_ids           | Local system identifiers for any Notifications associated with the patient                        | Notification.local_id                                                                   | A comma delimited list of identifiers linked to the patient using the `Notification`, `Act_relationship`, and `Participation` tables.                                          |
| sort.identification        | The most effective Identification used to sort patient values by identification                   | `derived from the rootExtensionTxt field of the most recent entity_id`                  |                                                                                                                                                                                |
| sort.phone                 | The most effective Phone number used to sort patient values by phone number                       | `derived from the telephoneNbr field of the most recent phone`                          |                                                                                                                                                                                |
| sort.address               | The most effective Address used to sort patient values by address                                 | `derived from the full field of the most recent address`                                |                                                                                                                                                                                |
| sort.email                 | The most effective Email address used to sort patient values by email                             | `derived from the emailAddress field of the most recent email`                          |                                                                                                                                                                                |
| sort.name                  | The most effective Name used to sort patient values by name                                       | `derived from the full field of the most recent name`                                   |                                                                                                                                                                                |
