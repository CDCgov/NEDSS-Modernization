package gov.cdc.nbs.patient;

import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Component;

@Component
public class PatientHistoryCreator {

  private static final int PATIENT_PARAMETER = 1;
  private static final int VERSION_PARAMETER = 2;
  private static final String CREATE = """
      insert into Person_hist (
          person_uid,
          version_ctrl_nbr,
          add_reason_cd,
          add_time,
          add_user_id,
          administrative_gender_cd,
          age_calc,
          age_calc_time,
          age_calc_unit_cd,
          age_category_cd,
          age_reported,
          age_reported_time,
          age_reported_unit_cd,
          birth_gender_cd,
          birth_order_nbr,
          birth_time,
          birth_time_calc,
          cd,
          cd_desc_txt,
          curr_sex_cd,
          deceased_ind_cd,
          deceased_time,
          [description],
          education_level_cd,
          education_level_desc_txt,
          ethnic_group_ind,
          last_chg_reason_cd,
          last_chg_time,
          last_chg_user_id,
          local_id,
          marital_status_cd,
          marital_status_desc_txt,
          mothers_maiden_nm,
          multiple_birth_ind,
          occupation_cd,
          preferred_gender_cd,
          prim_lang_cd,
          prim_lang_desc_txt,
          record_status_cd,
          record_status_time,
          status_cd,
          status_time,
          survived_ind_cd,
          user_affiliation_txt,
          first_nm,
          last_nm,
          middle_nm,
          nm_prefix,
          nm_suffix,
          preferred_nm,
          hm_street_addr1,
          hm_street_addr2,
          hm_city_cd,
          hm_city_desc_txt,
          hm_state_cd,
          hm_zip_cd,
          hm_cnty_cd,
          hm_cntry_cd,
          hm_phone_nbr,
          hm_phone_cntry_cd,
          hm_email_addr,
          cell_phone_nbr,
          wk_street_addr1,
          wk_street_addr2,
          wk_city_cd,
          wk_city_desc_txt,
          wk_state_cd,
          wk_zip_cd,
          wk_cnty_cd,
          wk_cntry_cd,
          wk_phone_nbr,
          wk_phone_cntry_cd,
          wk_email_addr,
          SSN,
          medicaid_num,
          dl_num,
          dl_state_cd,
          race_cd,
          race_seq_nbr,
          race_category_cd,
          ethnicity_group_cd,
          adults_in_house_nbr,
          children_in_house_nbr,
          birth_city_cd,
          birth_city_desc_txt,
          birth_cntry_cd,
          birth_state_cd,
          race_desc_txt,
          ethnic_group_desc_txt,
          as_of_date_admin,
          as_of_date_ethnicity,
          as_of_date_general,
          as_of_date_morbidity,
          as_of_date_sex,
          electronic_ind,
          person_parent_uid,
          dedup_match_ind,
          group_nbr,
          group_time,
          edx_ind,
          speaks_english_cd,
          additional_gender_cd,
          ehars_id,
          ethnic_unk_reason_cd,
          sex_unk_reason_cd
      )
      select
          person_uid,
          version_ctrl_nbr,
          add_reason_cd,
          add_time,
          add_user_id,
          administrative_gender_cd,
          age_calc,
          age_calc_time,
          age_calc_unit_cd,
          age_category_cd,
          age_reported,
          age_reported_time,
          age_reported_unit_cd,
          birth_gender_cd,
          birth_order_nbr,
          birth_time,
          birth_time_calc,
          cd,
          cd_desc_txt,
          curr_sex_cd,
          deceased_ind_cd,
          deceased_time,
          [description],
          education_level_cd,
          education_level_desc_txt,
          ethnic_group_ind,
          last_chg_reason_cd,
          last_chg_time,
          last_chg_user_id,
          local_id,
          marital_status_cd,
          marital_status_desc_txt,
          mothers_maiden_nm,
          multiple_birth_ind,
          occupation_cd,
          preferred_gender_cd,
          prim_lang_cd,
          prim_lang_desc_txt,
          record_status_cd,
          record_status_time,
          status_cd,
          status_time,
          survived_ind_cd,
          user_affiliation_txt,
          first_nm,
          last_nm,
          middle_nm,
          nm_prefix,
          nm_suffix,
          preferred_nm,
          hm_street_addr1,
          hm_street_addr2,
          hm_city_cd,
          hm_city_desc_txt,
          hm_state_cd,
          hm_zip_cd,
          hm_cnty_cd,
          hm_cntry_cd,
          hm_phone_nbr,
          hm_phone_cntry_cd,
          hm_email_addr,
          cell_phone_nbr,
          wk_street_addr1,
          wk_street_addr2,
          wk_city_cd,
          wk_city_desc_txt,
          wk_state_cd,
          wk_zip_cd,
          wk_cnty_cd,
          wk_cntry_cd,
          wk_phone_nbr,
          wk_phone_cntry_cd,
          wk_email_addr,
          SSN,
          medicaid_num,
          dl_num,
          dl_state_cd,
          race_cd,
          race_seq_nbr,
          race_category_cd,
          ethnicity_group_cd,
          adults_in_house_nbr,
          children_in_house_nbr,
          birth_city_cd,
          birth_city_desc_txt,
          birth_cntry_cd,
          birth_state_cd,
          race_desc_txt,
          ethnic_group_desc_txt,
          as_of_date_admin,
          as_of_date_ethnicity,
          as_of_date_general,
          as_of_date_morbidity,
          as_of_date_sex,
          electronic_ind,
          person_parent_uid,
          dedup_match_ind,
          group_nbr,
          group_time,
          edx_ind,
          speaks_english_cd,
          additional_gender_cd,
          ehars_id,
          ethnic_unk_reason_cd,
          sex_unk_reason_cd
      from Person
      where person_uid = ?
        and version_ctrl_nbr = ?
      """;

  private final JdbcTemplate template;

  public PatientHistoryCreator(final JdbcTemplate template) {
    this.template = template;
  }

  public void create(final long patient, final int version) {
    this.template.update(
        CREATE,
        statement -> {
          statement.setLong(PATIENT_PARAMETER, patient);
          statement.setInt(VERSION_PARAMETER, version);
        });
  }
}
